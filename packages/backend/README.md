# ğŸ”§ ë°±ì—”ë“œ API ì„œë²„

Express.js ê¸°ë°˜ì˜ RESTful API ì„œë²„ë¡œ, ë°°ê²½í™”ë©´ ë©”íƒ€ë°ì´í„° ê´€ë¦¬, íŒŒì¼ ì„œë¹™, ì‚¬ìš©ì ì¢‹ì•„ìš” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ“‹ ì£¼ìš” ê¸°ëŠ¥

- ğŸ–¼ï¸ **ë°°ê²½í™”ë©´ ê´€ë¦¬**: CRUD ì‘ì—… ë° ë©”íƒ€ë°ì´í„° ê´€ë¦¬
- ğŸ¨ **í…Œë§ˆ ë¶„ë¥˜**: í…Œë§ˆë³„ ë°°ê²½í™”ë©´ ë¶„ë¥˜ ë° ì¡°íšŒ
- â¤ï¸ **ì‚¬ìš©ì ì¢‹ì•„ìš”**: ì¢‹ì•„ìš” ì¶”ê°€/ì œê±° ë° ëª©ë¡ ê´€ë¦¬
- ğŸ” **ê²€ìƒ‰ ê¸°ëŠ¥**: í‚¤ì›Œë“œ ê¸°ë°˜ ë°°ê²½í™”ë©´ ê²€ìƒ‰
- ğŸ“ **íŒŒì¼ ì„œë¹™**: ì´ë¯¸ì§€ íŒŒì¼ ì •ì  ì„œë¹™ ë° ë‹¤ìš´ë¡œë“œ
- ğŸ›¡ï¸ **ì˜¤ë¥˜ ì²˜ë¦¬**: ì „ì—­ ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë¡œê¹…

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
src/
â”œâ”€â”€ routes/           # API ë¼ìš°í„°
â”‚   â”œâ”€â”€ wallpapers.ts # ë°°ê²½í™”ë©´ ê´€ë ¨ API
â”‚   â”œâ”€â”€ themes.ts     # í…Œë§ˆ ê´€ë ¨ API
â”‚   â””â”€â”€ users.ts      # ì‚¬ìš©ì ì¢‹ì•„ìš” API
â”œâ”€â”€ services/         # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ wallpaper-service.ts
â”‚   â”œâ”€â”€ theme-service.ts
â”‚   â””â”€â”€ user-preference-service.ts
â”œâ”€â”€ repositories/     # ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ
â”‚   â”œâ”€â”€ wallpaper-repository.ts
â”‚   â”œâ”€â”€ theme-repository.ts
â”‚   â””â”€â”€ user-repository.ts
â”œâ”€â”€ middleware/       # ë¯¸ë“¤ì›¨ì–´
â”‚   â””â”€â”€ error-handler.ts
â”œâ”€â”€ utils/           # ìœ í‹¸ë¦¬í‹°
â”‚   â””â”€â”€ json-storage.ts
â”œâ”€â”€ data/            # JSON ë°ì´í„° íŒŒì¼
â”‚   â”œâ”€â”€ wallpapers.json
â”‚   â”œâ”€â”€ themes.json
â”‚   â””â”€â”€ user-likes.json
â””â”€â”€ index.ts         # ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
```

## ğŸš€ ê°œë°œ í™˜ê²½ ì„¤ì •

### ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# ë£¨íŠ¸ì—ì„œ ì‹¤í–‰
npm install

# ë˜ëŠ” ë°±ì—”ë“œë§Œ ì„¤ì¹˜
npm install --workspace=packages/backend
```

### ê°œë°œ ì„œë²„ ì‹¤í–‰

```bash
# ë°±ì—”ë“œë§Œ ì‹¤í–‰
npm run dev:backend

# ë˜ëŠ” ë°±ì—”ë“œ ë””ë ‰í† ë¦¬ì—ì„œ
cd packages/backend
npm run dev
```

ì„œë²„ëŠ” http://localhost:3001ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

## ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸

### ë°°ê²½í™”ë©´ API

| ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸ | ì„¤ëª… |
|--------|------------|------|
| GET | `/api/wallpapers` | ëª¨ë“  ë°°ê²½í™”ë©´ ì¡°íšŒ |
| GET | `/api/wallpapers/:id` | íŠ¹ì • ë°°ê²½í™”ë©´ ì¡°íšŒ |
| GET | `/api/wallpapers/theme/:theme` | í…Œë§ˆë³„ ë°°ê²½í™”ë©´ ì¡°íšŒ |
| GET | `/api/wallpapers/search?q=keyword` | ë°°ê²½í™”ë©´ ê²€ìƒ‰ |

### í…Œë§ˆ API

| ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸ | ì„¤ëª… |
|--------|------------|------|
| GET | `/api/themes` | ëª¨ë“  í…Œë§ˆ ì¡°íšŒ |
| GET | `/api/themes/:id` | íŠ¹ì • í…Œë§ˆ ì¡°íšŒ |

### ì‚¬ìš©ì ì¢‹ì•„ìš” API

| ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸ | ì„¤ëª… |
|--------|------------|------|
| GET | `/api/users/:userId/likes` | ì‚¬ìš©ì ì¢‹ì•„ìš” ëª©ë¡ |
| POST | `/api/users/:userId/likes` | ì¢‹ì•„ìš” ì¶”ê°€ |
| DELETE | `/api/users/:userId/likes/:wallpaperId` | ì¢‹ì•„ìš” ì œê±° |

### íŒŒì¼ ë‹¤ìš´ë¡œë“œ API

| ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸ | ì„¤ëª… |
|--------|------------|------|
| GET | `/api/download/:id/:resolution` | íŠ¹ì • í•´ìƒë„ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ |

### ì •ì  íŒŒì¼ ì„œë¹™

| ê²½ë¡œ | ì„¤ëª… |
|------|------|
| `/uploads/wallpapers/` | ë°°ê²½í™”ë©´ ì´ë¯¸ì§€ íŒŒì¼ |
| `/uploads/thumbnails/` | ì¸ë„¤ì¼ ì´ë¯¸ì§€ íŒŒì¼ |
| `/uploads/icons/` | í…Œë§ˆ ì•„ì´ì½˜ íŒŒì¼ |

## ğŸ—‚ï¸ ë°ì´í„° êµ¬ì¡°

### ë°°ê²½í™”ë©´ ë°ì´í„° (wallpapers.json)

```json
{
  "id": "wp-001",
  "title": "ì•„ë¦„ë‹¤ìš´ ìì—° í’ê²½",
  "description": "í‘¸ë¥¸ ì‚°ê³¼ ë§‘ì€ í˜¸ìˆ˜ê°€ ì–´ìš°ëŸ¬ì§„ ìì—° í’ê²½",
  "themeId": "nature",
  "tags": ["ìì—°", "ì‚°", "í˜¸ìˆ˜", "í’ê²½"],
  "resolutions": [
    {
      "width": 1920,
      "height": 1080,
      "fileUrl": "/uploads/wallpapers/wp-001-1920x1080.jpg",
      "fileSize": 2048576
    }
  ],
  "thumbnailUrl": "/uploads/thumbnails/wp-001-thumb.jpg",
  "originalUrl": "/uploads/wallpapers/wp-001-original.jpg",
  "likeCount": 0,
  "downloadCount": 0,
  "createdAt": "2024-01-01T00:00:00.000Z",
  "updatedAt": "2024-01-01T00:00:00.000Z"
}
```

### í…Œë§ˆ ë°ì´í„° (themes.json)

```json
{
  "id": "nature",
  "name": "ìì—°",
  "description": "ìì—°ì˜ ì•„ë¦„ë‹¤ì›€ì„ ë‹´ì€ ë°°ê²½í™”ë©´",
  "iconUrl": "/uploads/icons/nature-icon.svg",
  "wallpaperCount": 15,
  "isActive": true,
  "sortOrder": 1,
  "createdAt": "2024-01-01T00:00:00.000Z"
}
```

### ì‚¬ìš©ì ì¢‹ì•„ìš” ë°ì´í„° (user-likes.json)

```json
{
  "id": "like-001",
  "userId": "user-123",
  "wallpaperId": "wp-001",
  "likedAt": "2024-01-01T00:00:00.000Z"
}
```

## ğŸ§ª í…ŒìŠ¤íŠ¸

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm test

# í…ŒìŠ¤íŠ¸ ê°ì‹œ ëª¨ë“œ
npm run test:watch

# ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸
npm run test:coverage

# í†µí•© í…ŒìŠ¤íŠ¸ë§Œ ì‹¤í–‰
npm run test:integration
```

### í…ŒìŠ¤íŠ¸ êµ¬ì¡°

```
src/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ wallpaper-service.test.ts      # ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ user-preference-service.test.ts
â”œâ”€â”€ repositories/
â”‚   â””â”€â”€ user-repository.test.ts
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ error-handler.test.ts
â”œâ”€â”€ integration/                       # í†µí•© í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ api.integration.test.ts
â”‚   â””â”€â”€ frontend-backend.integration.test.ts
â””â”€â”€ validation.test.ts                 # ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŠ¸
```

### ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŠ¸

ì´ í”„ë¡œì íŠ¸ëŠ” fast-checkë¥¼ ì‚¬ìš©í•œ ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŠ¸ë¥¼ í¬í•¨í•©ë‹ˆë‹¤:

- **ë°°ê²½í™”ë©´ ë°ì´í„° ìœ íš¨ì„±**: ëª¨ë“  ë°°ê²½í™”ë©´ ë°ì´í„°ê°€ ìœ íš¨í•œ í˜•ì‹ì„ ê°€ì ¸ì•¼ í•¨
- **ì¢‹ì•„ìš” ë°ì´í„° ì¼ê´€ì„±**: ì¢‹ì•„ìš” ì¶”ê°€/ì œê±° í›„ ë°ì´í„° ì¼ê´€ì„± ë³´ì¥
- **ê²€ìƒ‰ ê²°ê³¼ ê´€ë ¨ì„±**: ê²€ìƒ‰ ê²°ê³¼ê°€ ê²€ìƒ‰ì–´ì™€ ê´€ë ¨ì„±ì„ ê°€ì ¸ì•¼ í•¨
- **API ì‘ë‹µ í˜•ì‹**: ëª¨ë“  API ì‘ë‹µì´ ì •ì˜ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¤€ìˆ˜í•´ì•¼ í•¨

## ğŸ”§ ê°œë°œ ê°€ì´ë“œ

### ìƒˆë¡œìš´ API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€

1. **ë¼ìš°í„° ìƒì„±**: `src/routes/`ì— ìƒˆë¡œìš´ ë¼ìš°í„° íŒŒì¼ ìƒì„±
2. **ì„œë¹„ìŠ¤ êµ¬í˜„**: `src/services/`ì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„
3. **ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„**: `src/repositories/`ì— ë°ì´í„° ì ‘ê·¼ ë¡œì§ êµ¬í˜„
4. **í…ŒìŠ¤íŠ¸ ì‘ì„±**: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë° í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±

### ìƒˆë¡œìš´ ë°°ê²½í™”ë©´ ì¶”ê°€

1. ì´ë¯¸ì§€ íŒŒì¼ì„ `uploads/wallpapers/`ì— ì €ì¥
2. ì¸ë„¤ì¼ì„ `uploads/thumbnails/`ì— ì €ì¥
3. `src/data/wallpapers.json`ì— ë©”íƒ€ë°ì´í„° ì¶”ê°€

### ìƒˆë¡œìš´ í…Œë§ˆ ì¶”ê°€

1. í…Œë§ˆ ì•„ì´ì½˜ì„ `uploads/icons/`ì— ì €ì¥
2. `src/data/themes.json`ì— í…Œë§ˆ ì •ë³´ ì¶”ê°€

## ğŸ› ï¸ ë¹Œë“œ ë° ë°°í¬

### ê°œë°œ ë¹Œë“œ

```bash
npm run build
```

### í”„ë¡œë•ì…˜ ë¹Œë“œ

```bash
npm run build:prod
```

### í”„ë¡œë•ì…˜ ì„œë²„ ì‹¤í–‰

```bash
npm run start:prod
```

## ğŸ› ë¬¸ì œ í•´ê²°

### í¬íŠ¸ ì¶©ëŒ

ê¸°ë³¸ í¬íŠ¸ 3001ì´ ì‚¬ìš© ì¤‘ì¸ ê²½ìš°:

```bash
# í¬íŠ¸ ì‚¬ìš© í™•ì¸
netstat -ano | findstr :3001

# í™˜ê²½ ë³€ìˆ˜ë¡œ í¬íŠ¸ ë³€ê²½
PORT=3002 npm run dev
```

### íŒŒì¼ ì—…ë¡œë“œ ì˜¤ë¥˜

uploads ë””ë ‰í† ë¦¬ ê¶Œí•œ í™•ì¸:

```bash
# ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p uploads/wallpapers uploads/thumbnails uploads/icons

# ê¶Œí•œ ì„¤ì • (Linux/Mac)
chmod 755 uploads/
```

### JSON íŒŒì¼ ì˜¤ë¥˜

ë°ì´í„° íŒŒì¼ í˜•ì‹ ê²€ì¦:

```bash
# JSON í˜•ì‹ ê²€ì¦
node -e "console.log(JSON.parse(require('fs').readFileSync('src/data/wallpapers.json')))"
```

## ğŸ“Š ì„±ëŠ¥ ìµœì í™”

### ì´ë¯¸ì§€ ìµœì í™”

- ì¸ë„¤ì¼ ì´ë¯¸ì§€ëŠ” 300x200 í”½ì…€ë¡œ ìµœì í™”
- WebP í˜•ì‹ ì§€ì› ê³ ë ¤
- ì´ë¯¸ì§€ ì••ì¶• ë° ìºì‹± í—¤ë” ì„¤ì •

### API ìµœì í™”

- í˜ì´ì§€ë„¤ì´ì…˜ êµ¬í˜„
- ì‘ë‹µ ìºì‹±
- ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ì‹± (í–¥í›„ DB ë„ì… ì‹œ)

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

- CORS ì„¤ì •ìœ¼ë¡œ í—ˆìš©ëœ ë„ë©”ì¸ë§Œ ì ‘ê·¼
- Helmet.jsë¡œ ë³´ì•ˆ í—¤ë” ì„¤ì •
- íŒŒì¼ ì—…ë¡œë“œ ì‹œ íŒŒì¼ íƒ€ì… ê²€ì¦
- ì…ë ¥ ë°ì´í„° ê²€ì¦ ë° ìƒˆë‹ˆíƒ€ì´ì§•

## ğŸ“ ë¡œê¹…

ë¡œê·¸ íŒŒì¼ì€ `logs/` ë””ë ‰í† ë¦¬ì— ì €ì¥ë©ë‹ˆë‹¤:

- `error-YYYY-MM-DD.log`: ì˜¤ë¥˜ ë¡œê·¸
- `combined-YYYY-MM-DD.log`: ëª¨ë“  ë¡œê·¸ (ê°œë°œ ì‹œ)

## ğŸ”„ í–¥í›„ ê°œì„  ì‚¬í•­

- [ ] ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ (PostgreSQL/MongoDB)
- [ ] Redis ìºì‹± ì‹œìŠ¤í…œ ë„ì…
- [ ] ì´ë¯¸ì§€ CDN ì—°ë™
- [ ] ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ
- [ ] ê´€ë¦¬ì íŒ¨ë„
- [ ] API ë²„ì „ ê´€ë¦¬
- [ ] GraphQL API ì§€ì›