# 관리자 기능 설정 가이드

배경화면 웹사이트에서 나만 배경화면을 업로드할 수 있도록 관리자 기능을 설정하는 방법입니다.

## 1. 환경변수 설정

### 1.1 환경변수 파일 생성
프로젝트 루트에 `.env` 파일을 생성하고 다음 내용을 추가하세요:

```bash
# 관리자 설정 (중요: 안전한 키로 변경하세요!)
ADMIN_SECRET_KEY=your-super-secret-admin-key-here

# 서버 설정
BASE_URL=http://localhost:3002
ADMIN_PORT=3002
```

### 1.2 관리자 키 설정
`ADMIN_SECRET_KEY`를 안전한 값으로 변경하세요. 예시:
- `my-secure-admin-key-2024`
- `wallpaper-admin-xyz789`
- 또는 랜덤 문자열 생성기를 사용

⚠️ **보안 주의사항**: 
- 이 키를 다른 사람과 공유하지 마세요
- 프로덕션 환경에서는 더욱 복잡한 키를 사용하세요
- 정기적으로 키를 변경하는 것을 권장합니다

## 2. 서버 시작

다음 명령어들을 각각 다른 터미널에서 실행하세요:

```bash
# 1. 메인 백엔드 서버 시작 (포트 3001)
cd packages/backend
npm start

# 2. 관리자 서버 시작 (포트 3002)
cd packages/backend
node admin-server.js

# 3. 프론트엔드 서버 시작 (포트 3000)
cd packages/frontend
npm run dev
```

## 3. 관리자 로그인

1. 웹사이트 접속 (http://localhost:3000)
2. 우측 상단의 "관리자 로그인" 버튼 클릭
3. 설정한 `ADMIN_SECRET_KEY` 값 입력
4. 로그인 성공 시 "배경화면 업로드" 버튼이 나타남

## 4. 배경화면 업로드

1. "배경화면 업로드" 버튼 클릭
2. 업로드 폼에서 다음 정보 입력:
   - **배경화면 파일**: 이미지 파일 선택 (JPEG, PNG, WebP 지원, 최대 10MB)
   - **제목**: 배경화면 제목 (필수)
   - **설명**: 배경화면 설명 (선택사항)
   - **태그**: 쉼표로 구분된 태그 (예: "자연, 풍경, 산")
   - **테마**: 배경화면 카테고리 선택
3. "업로드" 버튼 클릭

## 5. 배경화면 관리

### 5.1 배경화면 삭제
- 관리자로 로그인한 상태에서 각 배경화면 카드 좌측 상단에 삭제 버튼(🗑️)이 표시됩니다
- 삭제 버튼 클릭 시 확인 대화상자가 나타나며, 확인하면 배경화면이 삭제됩니다

### 5.2 관리자 로그아웃
- 우측 상단의 "로그아웃" 버튼을 클릭하면 관리자 권한이 해제됩니다

## 6. 파일 저장 위치

업로드된 배경화면은 다음 위치에 저장됩니다:
- `packages/backend/uploads/` 디렉토리
- 파일명은 UUID로 자동 생성됩니다
- 배경화면 메타데이터는 `packages/backend/src/data/wallpapers.json`에 저장됩니다

## 7. 서버 구조

- **메인 백엔드 서버** (포트 3001): 기존 배경화면 조회, 다운로드 등의 기능
- **관리자 서버** (포트 3002): 관리자 전용 업로드, 삭제 기능
- **프론트엔드 서버** (포트 3000): 웹 인터페이스

## 8. 보안 고려사항

### 8.1 프로덕션 환경
프로덕션 환경에서는 다음 사항을 고려하세요:
- 더 복잡한 관리자 키 사용
- HTTPS 사용 필수
- 파일 업로드 크기 제한 검토
- 정기적인 키 변경

### 8.2 접근 제한
- 관리자 키를 아는 사람만 배경화면을 업로드할 수 있습니다
- 키를 분실한 경우 환경변수를 변경하여 새로운 키를 설정하세요

## 9. 문제 해결

### 9.1 로그인 실패
- 환경변수 `ADMIN_SECRET_KEY`가 올바르게 설정되었는지 확인
- 관리자 서버(포트 3002)가 정상적으로 실행 중인지 확인
- 브라우저 개발자 도구에서 네트워크 오류 확인

### 9.2 업로드 실패
- 파일 크기가 10MB 이하인지 확인
- 지원되는 파일 형식인지 확인 (JPEG, PNG, WebP)
- `packages/backend/uploads` 디렉토리 권한 확인

### 9.3 삭제 실패
- 관리자로 로그인되어 있는지 확인
- 파일 시스템 권한 확인

## 10. API 엔드포인트

관리자 기능 관련 API (포트 3002):
- `GET /api/admin/status` - 관리자 상태 확인
- `POST /api/admin/wallpapers` - 배경화면 업로드 (관리자 전용)
- `DELETE /api/admin/wallpapers/:id` - 배경화면 삭제 (관리자 전용)

모든 관리자 API는 `Authorization: Bearer {ADMIN_SECRET_KEY}` 헤더가 필요합니다.

## 11. 성공적인 설정 확인

모든 설정이 완료되면:
1. http://localhost:3000 에서 웹사이트가 정상적으로 로드됩니다
2. 우측 상단에 "관리자 로그인" 버튼이 표시됩니다
3. 관리자 키로 로그인하면 "배경화면 업로드" 버튼이 나타납니다
4. 업로드한 배경화면이 메인 페이지에 표시됩니다
5. 관리자 상태에서 배경화면 카드에 삭제 버튼이 표시됩니다